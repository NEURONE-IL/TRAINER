<div class="container">
  <!-- VISTA ETAPAS -->
  <show-stages [modulo]="selectedModule" (eventoVolver)="displayStages()" *ngIf="mostrarEtapas"></show-stages>

  <!-- VISTA MODULOS -->
  <div class="row etapas" *ngIf="!mostrarEtapas">
    <!-- Columna para manejar módulos -->
    <div class="col-md-8 azul">
      <!-- Sección para continuar módulos-->
      <div class="continuar" *ngIf="mostrarEtapas">
        <h2>Continuar</h2>
        <table mat-table [dataSource] = "modules" class="mat-elevation-z4">
          <!-- Columna nombre -->
          <ng-container matColumnDef="NombreCol">
            <th mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let stage"> {{stage.title}} </td>
          </ng-container>
          <!-- Columna tipo -->
          <ng-container matColumnDef="TipoCol">
            <th mat-header-cell *matHeaderCellDef> Tipo </th>
            <td mat-cell *matCellDef="let stage"> {{stage.type}} </td>
          </ng-container>
          
          <tr mat-header-row *matHeaderRowDef="columnHeader"></tr>
          <tr
            mat-row *matRowDef="let row; columns: columnHeader;"
            (click)="enClick(row)"
            [class.mat-row-is-clicked]="selectedModule==row"
          ></tr>

        </table>
      </div>
      <!-- Sección para módulos nuevos -->
      <div class="nuevo">
        <h2>Nuevo</h2>
        <table mat-table [dataSource] = "modules" class="mat-elevation-z4">
          <!-- Columna nombre -->
          <ng-container matColumnDef="NombreCol">
            <th mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let module"> {{module.name}} </td>
          </ng-container>
          <!-- Columna tipo -->
          <ng-container matColumnDef="TipoCol">
            <th mat-header-cell *matHeaderCellDef> Completado </th>
            <td mat-cell *matCellDef="let module"> 0/{{module.stages.length}}</td>
          </ng-container>
          
          <tr mat-header-row *matHeaderRowDef="columnHeader"></tr>
          <tr 
            mat-row *matRowDef="let row; columns: columnHeader;"
            (click)="enClick(row)"
            [class.mat-row-is-clicked]="selectedModule==row"
          ></tr>

        </table>
      </div>
    </div>
    <!-- Columna para manejar el módulo seleccionada -->
    <div class="col-md-4 rojo">
      <h2>Selección</h2>
      <span *ngIf=!selectedModule> <-Selecciona un módulo </span>
      <mat-card *ngIf=selectedModule>
        <mat-card-title>{{selectedModule.name}}</mat-card-title>	
        <mat-card-subtitle>Completado: 0</mat-card-subtitle>
        <mat-card-content>{{selectedModule.description}}</mat-card-content>
        <mat-card-actions>
          <button
            mat-raised-button color="primary"
            (click) = "displayStages()"
          >Iniciar!</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>

<!--<mat-grid-list cols="2" rowHeight="3:1">
  
  <mat-grid-tile>
    Tabla Continuar
  </mat-grid-tile>
  <mat-grid-tile rowspan="2">
    Carta etapa
  </mat-grid-tile>
  <mat-grid-tile>
    <table mat-table [dataSource] = "sortedStages">
      <ng-container matColumnDef="score">
        <th mat-header-cell *matHeaderCellDef> Score </th>
        <td mat-cell *matCellDef="let user"> {{user.score}} </td>
      </ng-container>
    </table>
  </mat-grid-tile>
</mat-grid-list>


  <div class="col-md-4" *ngFor="let stage of sortedStages; let index = index;">
    <br>
    <mat-card-header class="header-stage">
      <div class="  stages" >
        <mat-card-title class="{{getClass(stage.stage.active, stage.stage.type)}}">
          <div class="col-md-8" style="padding-top: 3%;">
            {{ "ADMIN.STAGES.TITLE" | translate }}: {{stage.stage.title}}
          </div>
        </mat-card-title>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div class=" stages-content">
        <div >
          <mat-card-subtitle>{{ "ADMIN.STAGES.TYPE" | translate }}: {{ stage.stage.type }} </mat-card-subtitle>
        </div>

        <div>
          <mat-icon>format_list_numbered</mat-icon><span class="aligned-with-icon">{{ "ADMIN.STAGES.STEP" | translate }}: {{stage.stage.step}}</span>
        </div>

        <div *ngIf="stage.active">
          <mat-icon >link</mat-icon><span class="aligned-with-icon"><a href="{{getLinkToTriviaStudy(stage.stage.externalId)}}">{{ "ADMIN.STAGES.LINK" | translate }}: {{stage.stage.externalName}}</a></span>
        </div>
        <div>
          <mat-icon>timelapse</mat-icon><span class="aligned-with-icon">{{ "ADMIN.STAGES.PERCENTAGE" | translate }}: {{stage.percentage}}%</span>
        </div>
        <div class="buttons2">
          <button  mat-raised-button color="primary" (click)="goToStage(stage.stage)">Iniciar!</button>
          <button  mat-raised-button color="secondary" (click)="updateProgress(stage.stage.externalId)">Simular Complete!</button>
        </div>
      </div>
    </mat-card-content>



  </div> -->